<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HelloPatient Overall Marketing Heat Map</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6; /* Light gray background */
        }
        .rating-card {
            padding: 1.5rem;
            border-radius: 0.75rem; /* rounded-xl */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* shadow-md */
            transition: all 0.2s ease-in-out;
            border: 1px solid;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            cursor: pointer; /* Make cards clickable */
        }
        .rating-card:hover {
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1); /* hover:shadow-lg */
            transform: scale(1.02); /* hover:scale-[1.02] */
        }
        .bg-green-100 { background-color: #d1fae5; } /* Tailwind green-100 */
        .border-green-300 { border-color: #a7f3d0; } /* Tailwind green-300 */
        .text-green-800 { color: #166534; } /* Tailwind green-800 */

        .bg-blue-100 { background-color: #dbeafe; } /* Tailwind blue-100 */
        .border-blue-300 { border-color: #93c5fd; } /* Tailwind blue-300 */
        .text-blue-800 { color: #1e40af; } /* Tailwind blue-800 */

        .bg-yellow-100 { background-color: #fef3c7; } /* Tailwind yellow-100 */
        .border-yellow-300 { border-color: #fcd34d; } /* Tailwind yellow-300 */
        .text-yellow-800 { color: #92400e; } /* Tailwind yellow-800 */

        .bg-red-100 { background-color: #fee2e2; } /* Tailwind red-100 */
        .border-red-300 { border-color: #fca5a5; } /* Tailwind red-300 */
        .text-red-800 { color: #991b1b; } /* Tailwind red-800 */

        /* Custom scrollbar for modal content */
        .modal-content-scrollable::-webkit-scrollbar {
            width: 8px;
        }
        .modal-content-scrollable::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        .modal-content-scrollable::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }
        .modal-content-scrollable::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
    </style>
</head>
<body class="p-4 sm:p-6 md:p-8">

    <div class="max-w-5xl mx-auto bg-white p-6 sm:p-8 rounded-xl shadow-lg border border-gray-200">
        <h1 class="text-3xl sm:text-4xl font-bold text-gray-900 mb-4 text-center">
            HelloPatient: Overall Marketing Effectiveness Heat Map
        </h1>
        <p class="text-lg text-gray-700 mb-8 text-center">
            This heat map provides a high-level overview of HelloPatient's marketing performance across nine key dimensions.
            Colors indicate the overall rating for each area, guiding your attention to strengths and opportunities.
        </p>

        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Dimension cards will be dynamically inserted here -->
        </div>

        <div class="mt-12 p-6 bg-gray-50 rounded-lg border border-gray-100">
            <h2 class="text-xl font-semibold text-gray-800 mb-3">Rating Key:</h2>
            <div class="grid grid-cols-2 sm:grid-cols-4 gap-4 text-sm font-medium">
                <div class="flex items-center gap-2">
                    <span class="block w-5 h-5 rounded-full bg-green-100 border border-green-300"></span>
                    <span class="text-green-800">Exceptional</span>
                </div>
                <div class="flex items-center gap-2">
                    <span class="block w-5 h-5 rounded-full bg-blue-100 border border-blue-300"></span>
                    <span class="text-blue-800">Competent</span>
                </div>
                <div class="flex items-center gap-2">
                    <span class="block w-5 h-5 rounded-full bg-yellow-100 border border-yellow-300"></span>
                    <span class="text-yellow-800">Needs Improvement</span>
                </div>
                <div class="flex items-center gap-2">
                    <span class="block w-5 h-5 rounded-full bg-red-100 border border-red-300"></span>
                    <span class="text-red-800">Critical Gap</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for LLM responses -->
    <div id="llmModal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center p-4 z-50 hidden">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col">
            <div class="p-6 border-b border-gray-200 flex justify-between items-center">
                <h2 id="llmModalTitle" class="text-2xl font-semibold text-gray-900"></h2>
                <button id="closeLlmModal" class="text-gray-500 hover:text-gray-700 text-3xl font-light leading-none">&times;</button>
            </div>
            <div class="p-6 overflow-y-auto modal-content-scrollable flex-grow">
                <div id="llmResponseContainer" class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                    <p id="llmResponseText" class="text-gray-700 animate-pulse">Generating insights...</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        const dimensionRatings = [
            { name: "Market Positioning & Messaging", rating: "Needs Improvement" },
            { name: "Buyer Journey Orchestration", rating: "Needs Improvement" },
            { name: "Market Presence & Visibility", rating: "Needs Improvement" },
            { name: "Audience Clarity & Segmentation", rating: "Needs Improvement" },
            { name: "Digital Experience Effectiveness", rating: "Needs Improvement" },
            { name: "Competitive Positioning & Defense", rating: "Needs Improvement" },
            { name: "Brand & Message Consistency", rating: "Competent" },
            { name: "Analytics & Measurement Framework", rating: "Needs Improvement" },
            { name: "Evaluation of AI-Specific Authenticity", rating: "Needs Improvement" }
        ];

        const cardsContainer = document.querySelector('.grid');
        const llmModal = document.getElementById('llmModal');
        const closeLlmModalBtn = document.getElementById('closeLlmModal');
        const llmModalTitle = document.getElementById('llmModalTitle');
        const llmResponseContainer = document.getElementById('llmResponseContainer');
        const llmResponseText = document.getElementById('llmResponseText');

        function getCardClasses(rating) {
            switch (rating) {
                case 'Exceptional': return 'bg-light-green border-green-300 text-dark-green';
                case 'Competent': return 'bg-light-blue border-blue-300 text-primary-blue';
                case 'Needs Improvement': return 'bg-light-gold border-yellow-300 text-primary-gold';
                case 'Critical Gap': return 'bg-red-100 border-red-300 text-red-800';
                default: return 'bg-neutral-light-grey border-gray-300 text-neutral-black';
            }
        }

        // LLM API Call Function
        async function callGeminiAPI(prompt, modalTitle) {
            llmModalTitle.textContent = modalTitle;
            llmResponseText.textContent = 'Generating insights...';
            llmResponseText.classList.add('animate-pulse');
            llmModal.classList.remove('hidden');

            let chatHistory = [];
            chatHistory.push({ role: "user", parts: [{ text: prompt }] });
            const payload = { contents: chatHistory };
            const apiKey = ""; // If you want to use models other than gemini-2.0-flash or imagen-3.0-generate-002, provide an API key here. Otherwise, leave this as-is.
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                const result = await response.json();

                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const text = result.candidates[0].content.parts[0].text;
                    llmResponseText.textContent = text;
                } else {
                    llmResponseText.textContent = 'Error: Could not generate insights. Please try again.';
                    console.error('Unexpected API response structure:', result);
                }
            } catch (error) {
                llmResponseText.textContent = 'Error: Failed to connect to the AI service. Please check your network or try again later.';
                console.error('Error calling Gemini API:', error);
            } finally {
                llmResponseText.classList.remove('animate-pulse');
            }
        }

        dimensionRatings.forEach(dimension => {
            const card = document.createElement('div');
            card.className = `rating-card ${getCardClasses(dimension.rating)}`;
            card.innerHTML = `
                <h3 class="text-xl font-semibold mb-2">${dimension.name}</h3>
                <p class="text-lg font-bold">Rating: ${dimension.rating}</p>
            `;

            // Add LLM buttons if rating is "Needs Improvement" or "Critical Gap"
            if (dimension.rating === "Needs Improvement" || dimension.rating === "Critical Gap") {
                const buttonContainer = document.createElement('div');
                buttonContainer.className = 'mt-4 flex flex-col gap-2 w-full';

                const summarizeBtn = document.createElement('button');
                summarizeBtn.className = 'bg-purple-600 hover:bg-purple-700 text-white text-sm font-semibold py-2 px-3 rounded-lg shadow-md transition-colors duration-200';
                summarizeBtn.textContent = '✨ Summarize Key Opportunities';
                summarizeBtn.onclick = () => {
                    const prompt = `HelloPatient's "${dimension.name}" dimension is rated "${dimension.rating}". Based on this, provide a concise summary (2-3 sentences) of the key opportunities for improvement for this dimension in the context of B2B SaaS healthcare AI.`;
                    callGeminiAPI(prompt, `Opportunities for ${dimension.name}`);
                };
                buttonContainer.appendChild(summarizeBtn);

                const quickWinBtn = document.createElement('button');
                quickWinBtn.className = 'bg-purple-600 hover:bg-purple-700 text-white text-sm font-semibold py-2 px-3 rounded-lg shadow-md transition-colors duration-200';
                quickWinBtn.textContent = '✨ Suggest a Quick Win';
                quickWinBtn.onclick = () => {
                    const prompt = `HelloPatient's "${dimension.name}" dimension is rated "${dimension.rating}". Suggest one specific, high-impact, low-effort "quick win" idea (1-2 sentences) to improve this dimension for a B2B SaaS healthcare AI company.`;
                    callGeminiAPI(prompt, `Quick Win for ${dimension.name}`);
                };
                buttonContainer.appendChild(quickWinBtn);

                card.appendChild(buttonContainer);
            }

            cardsContainer.appendChild(card);
        });

        closeLlmModalBtn.addEventListener('click', () => {
            llmModal.classList.add('hidden');
        });

        // Close modal when clicking outside
        llmModal.addEventListener('click', (e) => {
            if (e.target === llmModal) {
                llmModal.classList.add('hidden');
            }
        });
    </script>
</body>
</html>
